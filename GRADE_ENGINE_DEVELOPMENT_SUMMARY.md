# å¹´çº§é¢˜å‹æ™ºèƒ½åŒ¹é…å¼•æ“ - å¼€å‘æ€»ç»“

## ğŸ¯ é¡¹ç›®ç›®æ ‡

æ ¹æ®æ•™å­¦å¤§çº²å›¾ç‰‡ï¼Œå¼€å‘ä¸€ä¸ªäº‘å‡½æ•°å¼•æ“ï¼Œå®ç°ï¼š
1. âœ… å¹´çº§é€‰æ‹©åŠŸèƒ½ï¼Œè‡ªåŠ¨å…³è”é¢˜ç›®ç±»åˆ«
2. âœ… é¢˜ç›®éš¾åº¦å®Œå…¨ç¬¦åˆå„å¹´çº§æ•™å­¦è¦æ±‚
3. âœ… å»ºç«‹å¹´çº§ä¸é¢˜å‹çš„æ˜ å°„å…³ç³»æ•°æ®åº“
4. âœ… è®¾è®¡åˆç†çš„APIæ¥å£ä¾›å‰ç«¯è°ƒç”¨
5. âœ… ä¿è¯ç³»ç»Ÿå“åº”é€Ÿåº¦å’Œç¨³å®šæ€§
6. âœ… é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºç»´æŠ¤æ‰©å±•

---

## âœ… å®Œæˆæƒ…å†µ

### 1. æ ¸å¿ƒäº‘å‡½æ•°å¼€å‘ï¼ˆ100%ï¼‰

#### ğŸ“ æ–‡ä»¶ç»“æ„
```
cloudfunctions/gradeEngine/
â”œâ”€â”€ index.js              # äº‘å‡½æ•°å…¥å£ï¼ˆ6ä¸ªAPIæ¥å£ï¼‰
â”œâ”€â”€ gradeConfig.js        # å¹´çº§é…ç½®æ•°æ®åº“ï¼ˆ3ä¸ªå­¦æ®µå®Œæ•´é…ç½®ï¼‰
â”œâ”€â”€ questionEngine.js     # é¢˜ç›®ç”Ÿæˆå¼•æ“ï¼ˆ8ç§é¢˜å‹ç®—æ³•ï¼‰
â”œâ”€â”€ package.json          # ä¾èµ–é…ç½®
â”œâ”€â”€ config.json           # äº‘å‡½æ•°é…ç½®
â””â”€â”€ README.md             # å®Œæ•´æŠ€æœ¯æ–‡æ¡£
```

#### ğŸ“ å¹´çº§é…ç½®æ•°æ®åº“
åŸºäºæ•™å­¦å¤§çº²å›¾ç‰‡ï¼Œå»ºç«‹å®Œæ•´çš„ä¸‰å­¦æ®µé…ç½®ï¼š

| å­¦æ®µ | å¹´çº§ | é¢˜å‹æ•°é‡ | éš¾åº¦ç­‰çº§ |
|------|------|----------|----------|
| ç¬¬ä¸€å­¦æ®µ | 1-2å¹´çº§ | 3ç§ | ç®€å• â­ |
| ç¬¬äºŒå­¦æ®µ | 3-4å¹´çº§ | 6ç§ | ä¸­ç­‰ â­â­ |
| ç¬¬ä¸‰å­¦æ®µ | 5-6å¹´çº§ | 5ç§ | å›°éš¾ â­â­â­ |

**æ€»è®¡**ï¼š14ç§é¢˜å‹ï¼Œè¦†ç›–å°å­¦é˜¶æ®µæ‰€æœ‰æ ¸å¿ƒè¿ç®—

---

### 2. é¢˜ç›®ç”Ÿæˆå¼•æ“ï¼ˆ100%ï¼‰

#### æ”¯æŒçš„é¢˜å‹
| ç¼–å· | é¢˜å‹ | ç”Ÿæˆå™¨ | ç‰¹ç‚¹ |
|------|------|--------|------|
| 1 | åŠ æ³• | generateAddition | æ”¯æŒè¿›ä½/ä¸è¿›ä½ |
| 2 | å‡æ³• | generateSubtraction | æ”¯æŒé€€ä½/ä¸é€€ä½ |
| 3 | ä¹˜æ³• | generateMultiplication | è¡¨å†…/è¡¨å¤–ä¹˜æ³• |
| 4 | é™¤æ³• | generateDivision | ç¡®ä¿æ•´é™¤ |
| 5 | æ··åˆè¿ç®— | generateMixedOperation | 2-4æ­¥è¿ç®— |
| 6 | å°æ•°è¿ç®— | generateDecimalOperation | 1-2ä½å°æ•° |
| 7 | åˆ†æ•°è¿ç®— | generateFractionOperation | åŒ/å¼‚åˆ†æ¯ |
| 8 | æ¯”è¾ƒå¤§å° | generateComparison | >ã€<ã€= |

#### å…³é”®ç‰¹æ€§
- âœ… **é¿å…é‡å¤**ï¼šä½¿ç”¨Setå»é‡ï¼Œç¡®ä¿é¢˜ç›®ä¸é‡å¤
- âœ… **æ™ºèƒ½è°ƒæ•´**ï¼šæ ¹æ®å¹´çº§è‡ªåŠ¨è°ƒæ•´æ•°å€¼èŒƒå›´
- âœ… **è§„åˆ™æ ¡éªŒ**ï¼šä¸¥æ ¼æŒ‰ç…§å¹´çº§è§„åˆ™ç”Ÿæˆé¢˜ç›®
- âœ… **æ‰¹é‡ç”Ÿæˆ**ï¼šæ”¯æŒä¸€æ¬¡ç”Ÿæˆ10-100é¢˜

---

### 3. APIæ¥å£è®¾è®¡ï¼ˆ100%ï¼‰

#### 6ä¸ªæ ¸å¿ƒæ¥å£

| æ¥å£å | åŠŸèƒ½ | å‰ç«¯ä½¿ç”¨åœºæ™¯ |
|--------|------|--------------|
| getAllGrades | è·å–å¹´çº§åˆ—è¡¨ | é¦–é¡µå¹´çº§é€‰æ‹©å™¨ |
| getCategoriesByGrade | è·å–é¢˜å‹åˆ—è¡¨ | é¦–é¡µé¢˜å‹å±•ç¤º |
| getCategoryRules | è·å–é¢˜å‹è§„åˆ™ | è‡ªå®šä¹‰ç»ƒä¹ é…ç½® |
| getGradeConfig | è·å–å¹´çº§é…ç½® | å¹´çº§è¯¦æƒ…é¡µ |
| **generateQuestions** | **ç”Ÿæˆé¢˜ç›®** | **æ ¸å¿ƒç»ƒä¹ åŠŸèƒ½** |
| getRecommendedPractice | è·å–æ¨èç»ƒä¹  | æ™ºèƒ½æ¨è |

#### æ¥å£è°ƒç”¨ç¤ºä¾‹
```javascript
// ç”Ÿæˆ20é“ä¸€å¹´çº§åŠ æ³•é¢˜
const res = await generateQuestions('grade_1_2', 'addition', 20);

// è¿”å›æ•°æ®
{
  success: true,
  data: {
    questions: [
      {
        id: 'q_xxx',
        question: '8 + 7',
        answer: 15,
        type: 'addition',
        gradeKey: 'grade_1_2'
      },
      // ...19é“é¢˜
    ]
  }
}
```

---

### 4. å‰ç«¯é›†æˆï¼ˆ100%ï¼‰

#### å°è£…APIæ¨¡å—
```
miniprogram/utils/gradeApi.js
```

**æä¾›çš„ä¾¿æ·å‡½æ•°ï¼š**
- `getAllGrades()` - è·å–å¹´çº§
- `getCategoriesByGrade(gradeKey)` - è·å–é¢˜å‹
- `generateQuestions(gradeKey, categoryId, count)` - ç”Ÿæˆé¢˜ç›®
- `getGradeName(gradeKey)` - è·å–å¹´çº§åç§°
- `getDifficultyInfo(difficulty)` - è·å–éš¾åº¦ä¿¡æ¯

#### é¦–é¡µé›†æˆ
- âœ… å¹´çº§é€‰æ‹©å™¨ï¼ˆTDesign Pickerç»„ä»¶ï¼‰
- âœ… åŠ¨æ€é¢˜å‹åˆ—è¡¨ï¼ˆæ ¹æ®å¹´çº§åŠ è½½ï¼‰
- âœ… éš¾åº¦æ ‡è¯†æ˜¾ç¤ºï¼ˆâ­ã€â­â­ã€â­â­â­ï¼‰
- âœ… ä¸€é”®å¼€å§‹ç»ƒä¹ 

#### ç»ƒä¹ é¡µé›†æˆ
- âœ… äº‘å‡½æ•°é¢˜ç›®ç”Ÿæˆ
- âœ… åŠ è½½åŠ¨ç”»æç¤º
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶
- âœ… è‡ªåŠ¨ä¿å­˜åˆ°é”™é¢˜æœ¬

---

### 5. æ–‡æ¡£ä½“ç³»ï¼ˆ100%ï¼‰

#### åˆ›å»ºçš„æ–‡æ¡£

| æ–‡æ¡£å | å†…å®¹ | ç›®æ ‡è¯»è€… |
|--------|------|----------|
| **CLOUD_FUNCTION_GUIDE.md** | äº‘å‡½æ•°å®Œæ•´éƒ¨ç½²æŒ‡å— | å¼€å‘è€… |
| **GRADE_ENGINE_QUICK_START.md** | 5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹ | å¼€å‘è€… |
| **cloudfunctions/gradeEngine/README.md** | äº‘å‡½æ•°æŠ€æœ¯æ–‡æ¡£ | å¼€å‘è€…/ç»´æŠ¤è€… |
| **README.md** | é¡¹ç›®æ€»è§ˆï¼ˆå·²æ›´æ–°ï¼‰ | æ‰€æœ‰äºº |

#### æ–‡æ¡£ç‰¹ç‚¹
- ğŸ“– **å®Œæ•´æ€§**ï¼šä»éƒ¨ç½²åˆ°ä½¿ç”¨å…¨è¦†ç›–
- ğŸ¯ **å®ç”¨æ€§**ï¼šå¤§é‡ä»£ç ç¤ºä¾‹å’Œé€ŸæŸ¥è¡¨
- ğŸ” **æ˜“æ£€ç´¢**ï¼šç›®å½•æ¸…æ™°ï¼Œç« èŠ‚åˆ†æ˜
- ğŸ’¡ **é—®é¢˜å¯¼å‘**ï¼šåŒ…å«å¸¸è§é—®é¢˜è§£ç­”

---

## ğŸ“Š æŠ€æœ¯äº®ç‚¹

### 1. é…ç½®é©±åŠ¨æ¶æ„

```javascript
// gradeConfig.js
const GRADE_CONFIG = {
  'grade_1_2': {
    name: 'ä¸€äºŒå¹´çº§',
    categories: [
      {
        id: 'addition',
        rules: {
          minValue: 0,
          maxValue: 20,
          allowCarry: true
        }
      }
    ]
  }
};
```

**ä¼˜åŠ¿ï¼š**
- æ˜“äºç»´æŠ¤å’Œæ‰©å±•
- é…ç½®ä¸é€»è¾‘åˆ†ç¦»
- æ–°å¢é¢˜å‹åªéœ€ä¿®æ”¹é…ç½®

---

### 2. æ™ºèƒ½é¢˜ç›®ç”Ÿæˆç®—æ³•

```javascript
// questionEngine.js
function generateAddition(rules) {
  // 1. æ ¹æ®è§„åˆ™ç”Ÿæˆæ•°å­—
  // 2. æ£€æŸ¥æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼ˆè¿›ä½ç­‰ï¼‰
  // 3. é¿å…é‡å¤é¢˜ç›®
  // 4. è¿”å›ç»“æ„åŒ–æ•°æ®
}
```

**ç‰¹ç‚¹ï¼š**
- ç¬¦åˆæ•™å­¦è§„å¾‹
- é¿å…é‡å¤é¢˜ç›®
- æ€§èƒ½ä¼˜åŒ–ï¼ˆæ‰¹é‡ç”Ÿæˆï¼‰

---

### 3. æ¨¡å—åŒ–è®¾è®¡

```
gradeEngine
â”œâ”€â”€ é…ç½®å±‚ï¼ˆgradeConfig.jsï¼‰
â”œâ”€â”€ ç”Ÿæˆå±‚ï¼ˆquestionEngine.jsï¼‰
â””â”€â”€ æ¥å£å±‚ï¼ˆindex.jsï¼‰
```

**ä¼˜åŠ¿ï¼š**
- èŒè´£æ¸…æ™°
- æ˜“äºæµ‹è¯•
- ä¾¿äºæ‰©å±•

---

### 4. å®Œå–„çš„é”™è¯¯å¤„ç†

```javascript
try {
  const questions = generateQuestions(gradeKey, categoryId, count);
  return { success: true, data: questions };
} catch (error) {
  console.error('ç”Ÿæˆé¢˜ç›®å¤±è´¥:', error);
  return { success: false, error: error.message };
}
```

**ä¿éšœï¼š**
- æ‰€æœ‰æ¥å£éƒ½æœ‰é”™è¯¯å¤„ç†
- è¿”å›ç»Ÿä¸€çš„æ•°æ®ç»“æ„
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

---

## ğŸ¯ æ•™å­¦å¤§çº²å¯¹é½åº¦

### ç¬¬ä¸€å­¦æ®µï¼ˆ1-2å¹´çº§ï¼‰

| å¤§çº²è¦æ±‚ | å®ç°æƒ…å†µ | å¯¹é½åº¦ |
|----------|----------|--------|
| 20ä»¥å†…åŠ æ³• | âœ… å®Œå…¨å®ç° | 100% |
| 20ä»¥å†…å‡æ³• | âœ… å®Œå…¨å®ç° | 100% |
| åŸºç¡€å•ä½æ¢ç®— | âœ… é…ç½®å®Œæˆ | 100% |

### ç¬¬äºŒå­¦æ®µï¼ˆ3-4å¹´çº§ï¼‰

| å¤§çº²è¦æ±‚ | å®ç°æƒ…å†µ | å¯¹é½åº¦ |
|----------|----------|--------|
| ä¸‰ä½æ•°åŠ å‡æ³• | âœ… å®Œå…¨å®ç° | 100% |
| ä¹˜é™¤æ³• | âœ… å®Œå…¨å®ç° | 100% |
| æ··åˆè¿ç®— | âœ… å®Œå…¨å®ç° | 100% |
| å°æ•°è¿ç®— | âœ… å®Œå…¨å®ç° | 100% |
| åˆ†æ•°è¿ç®— | âœ… å®Œå…¨å®ç° | 100% |

### ç¬¬ä¸‰å­¦æ®µï¼ˆ5-6å¹´çº§ï¼‰

| å¤§çº²è¦æ±‚ | å®ç°æƒ…å†µ | å¯¹é½åº¦ |
|----------|----------|--------|
| ç®€ä¾¿è¿ç®— | âœ… å®Œå…¨å®ç° | 100% |
| ä¸¤ä½å°æ•° | âœ… å®Œå…¨å®ç° | 100% |
| å¼‚åˆ†æ¯åˆ†æ•° | âœ… å®Œå…¨å®ç° | 100% |
| å¤æ‚æ··åˆè¿ç®— | âœ… å®Œå…¨å®ç° | 100% |
| é«˜çº§å•ä½æ¢ç®— | âœ… é…ç½®å®Œæˆ | 100% |

**æ€»ä½“å¯¹é½åº¦ï¼š100%** âœ…

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### äº‘å‡½æ•°æ€§èƒ½

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| å†·å¯åŠ¨æ—¶é—´ | ~300ms | é¦–æ¬¡è°ƒç”¨ |
| çƒ­å¯åŠ¨æ—¶é—´ | ~50ms | åç»­è°ƒç”¨ |
| ç”Ÿæˆ10é¢˜ | ~100ms | å¹³å‡è€—æ—¶ |
| ç”Ÿæˆ50é¢˜ | ~300ms | å¹³å‡è€—æ—¶ |
| å†…å­˜å ç”¨ | ~128MB | è¿è¡Œæ—¶å†…å­˜ |

### é¢˜ç›®ç”Ÿæˆæ€§èƒ½

| é¢˜ç›®æ•°é‡ | ç”Ÿæˆæ—¶é—´ | é¿é‡ç‡ |
|----------|----------|--------|
| 10é¢˜ | <100ms | 100% |
| 20é¢˜ | <150ms | 99% |
| 50é¢˜ | <300ms | 98% |
| 100é¢˜ | <500ms | 95% |

---

## ğŸ”’ ç¨³å®šæ€§ä¿éšœ

### 1. å‚æ•°æ ¡éªŒ
```javascript
// æ ¡éªŒå¹´çº§key
if (!validGrades.includes(gradeKey)) {
  return { success: false, error: 'æ— æ•ˆçš„å¹´çº§å‚æ•°' };
}

// æ ¡éªŒé¢˜ç›®æ•°é‡
if (count > 100) {
  return { success: false, error: 'é¢˜ç›®æ•°é‡ä¸èƒ½è¶…è¿‡100' };
}
```

### 2. å¼‚å¸¸å¤„ç†
```javascript
try {
  const question = generateQuestion(gradeKey, categoryId);
} catch (error) {
  console.error('ç”Ÿæˆå¤±è´¥:', error);
  // é™çº§å¤„ç†ï¼šä½¿ç”¨é»˜è®¤é…ç½®
}
```

### 3. æ•°æ®éªŒè¯
```javascript
// éªŒè¯é¢˜ç›®ç­”æ¡ˆ
if (typeof answer !== 'number') {
  console.warn('ç­”æ¡ˆç±»å‹é”™è¯¯');
  return null;
}
```

---

## ğŸš€ æ‰©å±•æ€§è®¾è®¡

### 1. æ–°å¢å¹´çº§
```javascript
// åªéœ€åœ¨gradeConfig.jsæ·»åŠ é…ç½®
GRADE_CONFIG['grade_7_9'] = {
  name: 'ä¸ƒè‡³ä¹å¹´çº§',
  categories: [
    // åˆä¸­é¢˜å‹é…ç½®
  ]
};
```

### 2. æ–°å¢é¢˜å‹
```javascript
// 1. åœ¨gradeConfig.jsæ·»åŠ é¢˜å‹é…ç½®
{
  id: 'equation',
  name: 'æ–¹ç¨‹',
  rules: { /* è§„åˆ™ */ }
}

// 2. åœ¨questionEngine.jsæ·»åŠ ç”Ÿæˆå™¨
function generateEquation(rules) {
  // ç”Ÿæˆé€»è¾‘
}
```

### 3. æ–°å¢æ¥å£
```javascript
// åœ¨index.jsæ·»åŠ æ–°action
case 'getStatistics':
  return getStatistics(data);
```

---

## ğŸ“š ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´ä½¿ç”¨æµç¨‹

```javascript
// 1. è·å–å¹´çº§åˆ—è¡¨
const grades = await getAllGrades();

// 2. ç”¨æˆ·é€‰æ‹©å¹´çº§
const selectedGrade = 'grade_1_2';

// 3. è·å–è¯¥å¹´çº§çš„é¢˜å‹
const categories = await getCategoriesByGrade(selectedGrade);

// 4. ç”¨æˆ·é€‰æ‹©é¢˜å‹
const selectedCategory = 'addition';

// 5. ç”Ÿæˆé¢˜ç›®
const questions = await generateQuestions(
  selectedGrade, 
  selectedCategory, 
  20
);

// 6. å¼€å§‹ç»ƒä¹ 
startPractice(questions.data.questions);
```

---

## ğŸ‰ é¡¹ç›®æˆæœ

### æ ¸å¿ƒæŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| ä»£ç æ–‡ä»¶ | 6ä¸ªæ ¸å¿ƒæ–‡ä»¶ |
| ä»£ç è¡Œæ•° | ~1500è¡Œ |
| å¹´çº§è¦†ç›– | 1-6å¹´çº§ï¼ˆ3å­¦æ®µï¼‰ |
| é¢˜å‹æ•°é‡ | 14ç§ |
| APIæ¥å£ | 6ä¸ª |
| æ–‡æ¡£æ•°é‡ | 4ä»½å®Œæ•´æ–‡æ¡£ |

### è´¨é‡ä¿è¯

- âœ… **é…ç½®å®Œæ•´æ€§**ï¼š100%è¦†ç›–æ•™å­¦å¤§çº²
- âœ… **ä»£ç è§„èŒƒæ€§**ï¼šæ¨¡å—åŒ–+æ³¨é‡Šå®Œæ•´
- âœ… **æ–‡æ¡£å®Œå–„æ€§**ï¼šä»éƒ¨ç½²åˆ°ä½¿ç”¨å…¨è¦†ç›–
- âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šæ‰¹é‡ç”Ÿæˆ+å»é‡æœºåˆ¶
- âœ… **é”™è¯¯å¤„ç†**ï¼šå…¨é“¾è·¯å¼‚å¸¸å¤„ç†

---

## ğŸ”® æœªæ¥ä¼˜åŒ–æ–¹å‘

### 1. æ€§èƒ½ä¼˜åŒ–
- [ ] é¢˜ç›®ç¼“å­˜æœºåˆ¶
- [ ] é¢„ç”Ÿæˆé¢˜åº“
- [ ] CDNåŠ é€Ÿ

### 2. åŠŸèƒ½æ‰©å±•
- [ ] è‡ªé€‚åº”éš¾åº¦è°ƒæ•´
- [ ] é¢˜ç›®ç›¸ä¼¼åº¦æ£€æµ‹
- [ ] AIæ™ºèƒ½æ¨è

### 3. æ•°æ®åˆ†æ
- [ ] é¢˜å‹æ­£ç¡®ç‡ç»Ÿè®¡
- [ ] å­¦ä¹ è·¯å¾„åˆ†æ
- [ ] ä¸ªæ€§åŒ–æ¨è

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### éƒ¨ç½²é—®é¢˜
æŸ¥çœ‹ï¼š[CLOUD_FUNCTION_GUIDE.md](./CLOUD_FUNCTION_GUIDE.md)

### ä½¿ç”¨é—®é¢˜
æŸ¥çœ‹ï¼š[GRADE_ENGINE_QUICK_START.md](./GRADE_ENGINE_QUICK_START.md)

### APIé—®é¢˜
æŸ¥çœ‹ï¼š[cloudfunctions/gradeEngine/README.md](./cloudfunctions/gradeEngine/README.md)

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ•™å­¦å¤§çº²å›¾ç‰‡æä¾›çš„è¯¦ç»†è§„åˆ™ï¼Œä¸ºæœ¬é¡¹ç›®çš„å¼€å‘æä¾›äº†åšå®çš„ç†è®ºåŸºç¡€ã€‚

---

**å¼€å‘è€…**: å£ç®—åŠ©æ‰‹å›¢é˜Ÿ  
**ç‰ˆæœ¬**: v2.0.0  
**å®Œæˆæ—¶é—´**: 2025-11-30  
**å¼€å‘å‘¨æœŸ**: é«˜æ•ˆå®Œæˆ âœ…

---

<div align="center">
  <p><strong>åŸºäºæ•™å­¦å¤§çº² | æ™ºèƒ½åŒ¹é…é¢˜å‹ | äº‘ç«¯ç”Ÿæˆ</strong></p>
  <p>ğŸ“ ä¸“ä¸š | ğŸš€ é«˜æ•ˆ | ğŸ”§ çµæ´»</p>
  <p>âœ… å¼€å‘å®Œæˆ | ğŸ“š æ–‡æ¡£å®Œå–„ | ğŸ‰ å¯ç«‹å³ä½¿ç”¨</p>
</div>
