# 数的分解与组合 & 单位换算练习功能说明

## 📋 功能概览

新增两个独立练习模块：
1. **数的分解与组合练习** - 训练数感和加法思维
2. **单位换算练习** - 掌握生活中的度量衡概念

---

## 一、数的分解与组合练习

### 功能入口
**位置**：首页 → "数的分解与组合"卡片
- **分解练习按钮** → 10/20以内分解
- **组合练习按钮** → 三数相加训练

### 三种练习模式

#### 1. 基础版（10以内分解）
**适用年级**：一年级

**题目示例**：
```
目标数字: 7
? + ? = 7

正确答案示例:
- 1 + 6 = 7
- 2 + 5 = 7
- 3 + 4 = 7
```

**规则**：
- 随机生成2-10的整数N
- 用户输入两个非零加数A和B
- 满足 A + B = N
- 答案不唯一，任意有效组合均正确

**教学目标**：
- 理解数的组成
- 培养数感
- 为20以内加减法打基础

---

#### 2. 进阶版（20以内分解）
**适用年级**：二年级及以上

**题目示例**：
```
目标数字: 13
? + ? = 13

建议答案（凑十法）:
- 10 + 3 = 13
- 3 + 10 = 13
```

**规则**：
- 随机生成11-20的整数N
- 重点训练"凑十法"分解
- 鼓励拆分出10

**教学目标**：
- 掌握凑十法
- 理解十进制
- 提升心算速度

---

#### 3. 拓展版（三数相加）
**适用年级**：二年级及以上

**题目示例**：
```
目标数字: 9
? + ? + ? = 9

正确答案示例:
- 2 + 3 + 4 = 9
- 1 + 1 + 7 = 9
- 3 + 3 + 3 = 9
```

**规则**：
- 随机生成6-10的整数N
- 用户输入三个非零加数A、B、C
- 满足 A + B + C = N
- 答案不唯一

**教学目标**：
- 训练多步运算
- 培养组合思维
- 提升计算灵活性

---

### 页面设计

#### 界面布局
```
┌─────────────────────────────────┐
│  进度: 5/20    模式名称    时间  │
├─────────────────────────────────┤
│         目标数字                │
│            15                   │
│                                 │
│    [?] + [?] = 15              │
│     ↑    ↑                     │
│   输入框 输入框                 │
│                                 │
│  💡 请输入两个非零加数          │
├─────────────────────────────────┤
│      [提交答案]                 │
├─────────────────────────────────┤
│  ▓▓▓▓▓▓▓░░░░░ 25%             │
└─────────────────────────────────┘
```

#### 交互流程
1. 显示目标数字（大号粗体）
2. 用户在输入框中填写加数
3. 点击"提交答案"
4. 验证规则：
   - 所有输入框已填写 ✓
   - 所有加数非零 ✓
   - 加数之和等于目标数字 ✓
5. 显示反馈动画（✓ 或 ✗）
6. 1.2秒后自动进入下一题

#### 答案验证逻辑
```javascript
// 基础版和进阶版
isCorrect = (num1 !== 0 && num2 !== 0 && num1 + num2 === targetNumber)

// 拓展版
isCorrect = (num1 !== 0 && num2 !== 0 && num3 !== 0 && num1 + num2 + num3 === targetNumber)
```

---

## 二、单位换算练习

### 功能入口
**位置**：首页 → "单位换算练习"卡片
- 长度（米↔厘米）
- 重量（千克↔克）
- 人民币（元↔角↔分）
- 时间（时↔分↔秒，年↔月）

### 四大类别

#### 1. 长度单位换算
**适用年级**：二年级及以上

**换算规则**：
- 1米 = 100厘米

**题目类型**：

**① 简单换算**
```
5米 = ? 厘米
答案: 500

120厘米 = ? 米
答案: 1.2
```

**② 复杂换算**（带余数）
```
350厘米 = ? 米 ? 厘米
答案: 3米50厘米
```

---

#### 2. 重量单位换算
**适用年级**：三年级及以上

**换算规则**：
- 1千克 = 1000克

**题目类型**：

**① 简单换算**
```
3千克 = ? 克
答案: 3000

5000克 = ? 千克
答案: 5
```

**② 复杂换算**
```
2500克 = ? 千克 ? 克
答案: 2千克500克
```

---

#### 3. 人民币单位换算
**适用年级**：一年级及以上

**换算规则**：
- 1元 = 10角
- 1角 = 10分
- 1元 = 100分

**题目类型**：

**① 单级换算**
```
7元 = ? 角
答案: 70

50角 = ? 元
答案: 5

3角 = ? 分
答案: 30
```

**② 混合换算**
```
3元5角 = ? 角
答案: 35

150分 = ? 元 ? 角
答案: 1元5角
```

---

#### 4. 时间单位换算
**适用年级**：二年级及以上

**换算规则**：
- 1时 = 60分
- 1分 = 60秒
- 1年 = 12月

**题目类型**：

**① 时分换算**
```
2时 = ? 分
答案: 120

180分 = ? 时
答案: 3
```

**② 分秒换算**
```
5分 = ? 秒
答案: 300

240秒 = ? 分
答案: 4
```

**③ 年月换算**
```
3年 = ? 月
答案: 36

24月 = ? 年
答案: 2
```

---

### 页面设计

#### 界面布局（简单换算）
```
┌─────────────────────────────────┐
│  5/20     长度单位     02:15    │
├─────────────────────────────────┤
│      请完成单位换算             │
│                                 │
│     ┌─────────┐                │
│     │  5 米   │                │
│     └─────────┘                │
│          =                      │
│     ┌─────────┐                │
│     │ [?]厘米 │                │
│     └─────────┘                │
│                                 │
│  💡 请输入换算后的数值          │
├─────────────────────────────────┤
│      [提交答案]                 │
├─────────────────────────────────┤
│  ▓▓▓▓▓░░░░░░░ 25%             │
└─────────────────────────────────┘
```

#### 界面布局（复杂换算）
```
┌─────────────────────────────────┐
│  8/20     长度单位     03:42    │
├─────────────────────────────────┤
│      请完成单位换算             │
│                                 │
│     ┌─────────────┐            │
│     │ 350 厘米    │            │
│     └─────────────┘            │
│          =                      │
│   ┌────┐       ┌────┐         │
│   │[?]米│       │[?]厘米│     │
│   └────┘       └────┘         │
│                                 │
│  💡 请输入换算后的数值          │
├─────────────────────────────────┤
│      [提交答案]                 │
├─────────────────────────────────┤
│  ▓▓▓▓▓▓▓▓░░░░ 40%             │
└─────────────────────────────────┘
```

#### 题目生成逻辑
```javascript
// 简单换算：直接乘除
sourceValue × rate = targetValue

// 复杂换算：带余数拆分
totalSmallUnits ÷ rate = largeUnits ... remainingSmallUnits
例: 350厘米 ÷ 100 = 3米 ... 50厘米
```

---

## 技术实现

### 文件结构

```
miniprogram/pages/
├── decompose/              # 数的分解与组合
│   ├── index.js           # 页面逻辑
│   ├── index.wxml         # 页面结构
│   ├── index.wxss         # 页面样式
│   └── index.json         # 页面配置
│
└── unit/                   # 单位换算
    ├── index.js           # 页面逻辑
    ├── index.wxml         # 页面结构
    ├── index.wxss         # 页面样式
    └── index.json         # 页面配置
```

### 页面跳转参数

#### 分解练习
```javascript
// 从首页跳转
wx.navigateTo({
  url: '/pages/decompose/index?mode=basic&count=20'
});

// 参数说明
mode: 'basic' | 'advanced' | 'triple'  // 练习模式
count: number  // 题目数量（默认20）
```

#### 单位换算
```javascript
// 从首页跳转
wx.navigateTo({
  url: '/pages/unit/index?type=length&count=20'
});

// 参数说明
type: 'length' | 'weight' | 'money' | 'time'  // 单位类型
count: number  // 题目数量（默认20）
```

### 数据配置

#### 分解练习模式配置
```javascript
modeConfig: {
  basic: { 
    name: '10以内分解', 
    min: 2, 
    max: 10, 
    inputs: 2 
  },
  advanced: { 
    name: '20以内分解', 
    min: 11, 
    max: 20, 
    inputs: 2 
  },
  triple: { 
    name: '三数相加', 
    min: 6, 
    max: 10, 
    inputs: 3 
  }
}
```

#### 单位换算配置
```javascript
unitConfig: {
  length: {
    name: '长度单位',
    icon: 'ruler',
    color: '#4A90E2',
    conversions: [
      { from: '米', to: '厘米', rate: 100 },
      { from: '厘米', to: '米', rate: 0.01 }
    ]
  },
  weight: {
    name: '重量单位',
    conversions: [
      { from: '千克', to: '克', rate: 1000 }
    ]
  },
  money: {
    name: '人民币单位',
    conversions: [
      { from: '元', to: '角', rate: 10 },
      { from: '角', to: '分', rate: 10 },
      { from: '元', to: '分', rate: 100 }
    ]
  },
  time: {
    name: '时间单位',
    conversions: [
      { from: '时', to: '分', rate: 60 },
      { from: '分', to: '秒', rate: 60 },
      { from: '年', to: '月', rate: 12 }
    ]
  }
}
```

---

## UI/UX 设计亮点

### 1. 渐变背景
- **分解练习**：紫色渐变 (`#667eea → #764ba2`)
- **单位换算**：粉红渐变 (`#f093fb → #f5576c`)

### 2. 反馈动画
- ✅ **正确**：绿色✓图标 + "回答正确！"
- ❌ **错误**：红色✗图标 + 显示正确答案
- 缩放弹出动画（`scaleIn` 0.4s）
- 1.2秒后自动消失

### 3. 即时反馈
- 输入验证（非零、范围检查）
- Toast消息提示
- 震动反馈（正确=轻震动，错误=中震动）

### 4. 进度可视化
- 顶部进度文本：`5/20`
- 底部进度条：彩色填充
- 实时计时器：`MM:SS` 格式

### 5. 输入体验优化
- 数字键盘自动弹出（`type="number"` / `type="digit"`）
- 输入框居中对齐
- 大号字体便于阅读
- 蓝色边框高亮

---

## 数据存储

### 练习记录格式
```javascript
{
  id: "pr_1701234567890",
  type: "decompose" | "unit",
  createTime: 1701234567890,
  answers: [
    {
      question: "7 = ? + ?",
      userAnswer: [2, 5],
      correctAnswer: 7,  // 分解练习验证总和
      isCorrect: true
    },
    {
      question: "5米 = ? 厘米",
      userAnswer: 500,
      correctAnswer: 500,
      isCorrect: true
    }
  ],
  correctCount: 18,
  totalCount: 20,
  correctRate: 90,
  duration: 125  // 秒
}
```

### 本地存储键
- `practiceRecords` - 练习记录数组（最多100条）
- `selectedCount` - 用户选择的题目数量

---

## 测试用例

### 分解练习测试

| 测试项 | 输入 | 预期输出 |
|--------|------|----------|
| 基础版正确答案 | 目标7，输入2+5 | ✅ 正确 |
| 基础版错误答案 | 目标7，输入3+5 | ❌ 你的答案：8 |
| 零值输入 | 目标7，输入0+7 | ⚠️ 加数不能为0 |
| 空输入 | 目标7，输入空 | ⚠️ 请填写所有答案 |
| 三数相加正确 | 目标9，输入2+3+4 | ✅ 正确 |

### 单位换算测试

| 测试项 | 输入 | 预期输出 |
|--------|------|----------|
| 米转厘米 | 5米=?厘米，输入500 | ✅ 正确 |
| 厘米转米 | 120厘米=?米，输入1.2 | ✅ 正确 |
| 复杂换算 | 350厘米=?米?厘米，输入3和50 | ✅ 正确 |
| 错误答案 | 5米=?厘米，输入50 | ❌ 正确答案：500 |
| 空输入 | 5米=?厘米，输入空 | ⚠️ 请填写答案 |

---

## 使用说明

### 1. 首次使用
1. 打开小程序，进入首页
2. 选择年级和题目数量
3. 点击对应功能卡片开始练习

### 2. 分解练习
- **适合场景**：睡前5分钟训练、碎片时间练习
- **建议设置**：10-20道题
- **学习技巧**：
  - 基础版：尝试多种组合方式
  - 进阶版：优先尝试凑十法
  - 三数相加：寻找规律组合

### 3. 单位换算
- **适合场景**：日常生活联系、应用题准备
- **建议设置**：20道题
- **学习技巧**：
  - 记住换算倍率
  - 复杂换算先算整数再算余数
  - 联想生活实例加深记忆

### 4. 查看结果
- 完成后自动跳转结果页
- 显示正确率、用时、题目数量
- 可返回首页继续练习

---

## 后续优化方向

### 功能扩展
- [ ] 错题回顾模式
- [ ] 难度自适应（根据正确率调整）
- [ ] 排行榜和成就系统
- [ ] 家长监控面板

### 题目类型
- [ ] 数的分解：四数相加、五数相加
- [ ] 单位换算：面积（平方米↔平方厘米）
- [ ] 单位换算：体积（升↔毫升）

### UI优化
- [ ] 夜间模式
- [ ] 答题音效
- [ ] 星星奖励动画
- [ ] 自定义主题

---

## 技术栈

- **框架**：微信小程序原生框架
- **UI组件**：TDesign Miniprogram
- **状态管理**：本地存储（localStorage）
- **动画**：CSS3 Animations

---

## 开发完成检查清单

✅ 数的分解与组合页面
  - ✅ index.js（业务逻辑）
  - ✅ index.wxml（页面结构）
  - ✅ index.wxss（样式设计）
  - ✅ index.json（页面配置）

✅ 单位换算页面
  - ✅ index.js（业务逻辑）
  - ✅ index.wxml（页面结构）
  - ✅ index.wxss（样式设计）
  - ✅ index.json（页面配置）

✅ 页面注册
  - ✅ app.json 添加页面路径

✅ 首页集成
  - ✅ 更新 goToDecompose 函数
  - ✅ 更新 goToUnit 函数
  - ✅ 优化按钮描述文案

---

## 立即体验

1. **重新编译小程序**
2. **进入首页**
3. **选择年级和题目数量**
4. **点击功能卡片开始练习**

祝学习愉快！🎉
