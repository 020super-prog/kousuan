# 首页UI优化 - 快速测试指南

## 🎯 测试目标

验证首页的年级选择和题目数量自定义功能是否正常工作。

---

## ⏱️ 预计测试时间：5-10分钟

---

## 📋 测试检查清单

### 第一部分：年级选择功能（3分钟）

#### ✅ 测试步骤

**步骤1：查看初始状态**
```
期望结果：
□ 看到6个年级按钮：一、二、三、四、五、六
□ 一年级按钮默认为蓝色高亮状态
□ 其他年级为灰色未选中状态
□ 按钮排列整齐，3列2行网格布局
```

**步骤2：切换到二年级**
```
操作：点击"二年级"按钮

期望结果：
□ 二年级按钮变为蓝色高亮
□ 一年级按钮变回灰色
□ 顶部显示Toast提示："已切换到二年级"
□ 口算练习卡片标题显示"（二年级 · 20道题）"
□ 下方题型按钮内容更新
```

**步骤3：测试其他年级**
```
操作：依次点击三、四、五、六年级

期望结果：
□ 每次点击都有蓝色高亮反馈
□ 每次都显示Toast提示
□ 卡片标题正确更新
□ 只有一个年级按钮高亮
```

**步骤4：验证状态保持**
```
操作：
1. 选择"五年级"
2. 关闭小程序（点击右上角X或切换到其他应用）
3. 重新打开小程序

期望结果：
□ 五年级按钮仍然是蓝色高亮
□ 口算练习显示"（五年级 · X道题）"
```

---

### 第二部分：题目数量选择功能（3分钟）

#### ✅ 测试步骤

**步骤1：查看初始状态**
```
期望结果：
□ 看到题目数量选择区域
□ 显示4个按钮：10道题、20道题、50道题、自定义
□ 20道题按钮默认为橙色高亮状态
```

**步骤2：选择预设数量**
```
操作：点击"10道题"按钮

期望结果：
□ 10道题按钮变为橙色高亮
□ 20道题按钮变回灰色
□ 显示Toast提示："已设置为10道题"
□ 口算练习卡片标题更新为"（X年级 · 10道题）"
```

**步骤3：测试其他预设**
```
操作：点击"50道题"按钮

期望结果：
□ 50道题按钮变为橙色高亮
□ 其他按钮变回灰色
□ 显示Toast："已设置为50道题"
□ 卡片标题正确更新
```

**步骤4：测试自定义输入（有效值）**
```
操作：
1. 点击"自定义"按钮
2. 在输入框中输入"30"
3. 点击"确定"按钮

期望结果：
□ 点击自定义后，展开输入框（虚线边框）
□ 输入框可以正常输入数字
□ 点击确定后，输入框收起
□ 显示Toast："已设置为30道题"
□ 自定义按钮变为橙色高亮
□ 卡片标题显示"（X年级 · 30道题）"
```

**步骤5：测试自定义输入（无效值）**
```
操作A：输入"0"并确定
期望结果：
□ 显示错误提示："请输入1-200之间的数字"
□ 输入框不收起
□ 原设置不变

操作B：输入"300"并确定
期望结果：
□ 显示错误提示："请输入1-200之间的数字"
□ 输入框不收起
□ 原设置不变

操作C：输入"abc"并确定
期望结果：
□ 显示错误提示："请输入1-200之间的数字"
□ 输入框不收起
□ 原设置不变
```

**步骤6：测试取消操作**
```
操作：
1. 点击"自定义"按钮
2. 输入"100"
3. 点击"取消"按钮

期望结果：
□ 输入框收起
□ 原设置保持不变（如之前是30道题，仍然是30道题）
□ 不显示Toast提示
```

**步骤7：验证状态保持**
```
操作：
1. 设置为"50道题"
2. 关闭小程序
3. 重新打开

期望结果：
□ 50道题按钮仍然是橙色高亮
□ 卡片标题显示"（X年级 · 50道题）"
```

---

### 第三部分：组合功能测试（2分钟）

**场景1：完整流程**
```
操作：
1. 选择"三年级"
2. 选择"10道题"
3. 点击"加法"题型按钮

期望结果：
□ 跳转到练习页面
□ 练习页标题显示"三年级 - 加法"
□ 生成10道加法题
□ 题目难度符合三年级水平
```

**场景2：自定义流程**
```
操作：
1. 选择"六年级"
2. 自定义"15道题"
3. 点击"混合运算"题型按钮

期望结果：
□ 跳转到练习页面
□ 生成15道六年级混合运算题
```

**场景3：边界测试**
```
操作：
1. 选择"一年级"
2. 自定义"1道题"（最小值）
3. 点击任意题型

期望结果：
□ 正常跳转
□ 生成1道题

操作：
4. 返回首页
5. 自定义"200道题"（最大值）
6. 点击任意题型

期望结果：
□ 正常跳转
□ 生成200道题
```

---

## 🐛 常见问题排查

### 问题1：年级按钮不显示或显示异常

**可能原因：**
- WXML模板语法错误
- 数据绑定问题

**排查步骤：**
1. 打开控制台，查看是否有错误信息
2. 检查 `gradeOptions` 数据是否正确加载：
   ```javascript
   // 在控制台输入
   getCurrentPages()[0].data.gradeOptions
   ```
3. 应该看到6个年级的数据数组

**解决方法：**
- 确认 `index.wxml` 和 `index.js` 文件已正确保存
- 重新编译小程序

---

### 问题2：点击年级按钮无反应

**可能原因：**
- 事件绑定问题
- JavaScript代码错误

**排查步骤：**
1. 查看控制台是否有JS错误
2. 检查 `selectGrade` 方法是否存在
3. 测试点击是否触发事件：在 `selectGrade` 开头添加日志
   ```javascript
   selectGrade(e) {
     console.log('点击年级按钮', e);
     // ...
   }
   ```

**解决方法：**
- 确认 `bindtap="selectGrade"` 绑定正确
- 检查方法名拼写

---

### 问题3：题型不加载或加载错误

**可能原因：**
- 云函数调用失败
- 年级格式转换错误

**排查步骤：**
1. 查看控制台输出的年级信息：
   ```
   选择年级: grade_3 三年级
   ```
2. 检查是否有云函数错误
3. 验证 `convertToCloudFormat` 方法

**解决方法：**
- 确认云函数已部署
- 确认云环境ID已配置
- 检查网络连接

---

### 问题4：自定义输入框不显示

**可能原因：**
- 条件渲染失败
- 数据状态错误

**排查步骤：**
1. 检查 `isCustomCount` 的值：
   ```javascript
   getCurrentPages()[0].data.isCustomCount
   ```
2. 应该在点击"自定义"后变为 `true`

**解决方法：**
- 检查 `wx:if="{{isCustomCount}}"` 语法
- 确认 `setData` 调用正确

---

### 问题5：状态不持久化

**可能原因：**
- 本地存储失败
- 读取逻辑错误

**排查步骤：**
1. 检查存储是否成功：
   ```javascript
   wx.getStorageSync('selectedGrade')
   wx.getStorageSync('selectedCount')
   ```
2. 应该返回相应的值

**解决方法：**
- 确认 `wx.setStorageSync` 调用正确
- 检查 `loadSelectedGrade` 和 `loadSelectedCount` 方法

---

## 📸 UI截图对比

### 年级选择区域

**正常状态：**
```
┌───────────────────────────────────┐
│  📚 选择年级                       │
├───────────────────────────────────┤
│  ┌─────┐ ┌─────┐ ┌─────┐          │
│  │  一 │ │  二 │ │  三 │          │
│  │年级│ │年级│ │年级│          │
│  └─────┘ └─────┘ └─────┘          │
│  ┌─────┐ ┌─────┐ ┌─────┐          │
│  │  四 │ │  五 │ │  六 │          │
│  │年级│ │年级│ │年级│ ← 蓝色高亮│
│  └─────┘ └─────┘ └─────┘          │
└───────────────────────────────────┘
```

### 题目数量区域

**正常状态：**
```
┌───────────────────────────────────┐
│  📊 题目数量                       │
├───────────────────────────────────┤
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ │
│  │  10 │ │  20 │ │  50 │ │  ✏️ │ │
│  │道题│ │道题│ │道题│ │自定义│ │
│  └─────┘ └─────┘ └─────┘ └─────┘ │
│           ↑ 橙色高亮               │
└───────────────────────────────────┘
```

**自定义输入状态：**
```
┌───────────────────────────────────┐
│  ┌ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┐ │
│  │ 输入题目数量(1-200)           │ │
│  │    [      30      ]           │ │
│  └ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┘ │
│  ┌─────────┐     ┌─────────┐     │
│  │  取消   │     │  确定   │     │
│  └─────────┘     └─────────┘     │
└───────────────────────────────────┘
```

---

## ✅ 测试完成标准

当以上所有测试项都打勾（□ → ☑）时，说明功能正常，可以发布。

### 关键验收点

- [ ] 6个年级按钮全部可点击且正常切换
- [ ] 年级选择有高亮反馈和Toast提示
- [ ] 题型列表随年级正确更新
- [ ] 3个预设数量按钮正常工作
- [ ] 自定义输入支持1-200范围
- [ ] 无效输入有错误提示
- [ ] 取消操作正常工作
- [ ] 年级和数量选择可持久化
- [ ] 点击题型能跳转到练习页，且传递正确参数

---

## 🎉 测试通过后

恭喜！新版UI已经可以正常使用了。

### 后续建议

1. **多设备测试**：在不同型号的手机上测试
2. **长时间测试**：连续使用1小时，观察是否有性能问题
3. **用户反馈**：收集实际用户的使用体验

### 如果发现问题

请记录以下信息：
- 问题描述
- 复现步骤
- 控制台日志
- 截图/录屏

然后查阅 `HOME_UI_UPGRADE.md` 文档或联系开发团队。

---

**测试指南版本:** v1.0  
**适用版本:** v1.1.0+  
**最后更新:** 2025-11-30
