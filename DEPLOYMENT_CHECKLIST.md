# 年级题型引擎部署清单

## 📋 部署前检查

### ✅ 环境准备

- [ ] 已安装Node.js v20.13.1
- [ ] 已安装npm 10.9.2
- [ ] 已安装微信开发者工具（最新版）
- [ ] 已注册微信小程序账号
- [ ] 已开通云开发服务

---

## 🚀 部署步骤

### 步骤1：初始化云开发环境

- [ ] 在微信开发者工具中打开项目
- [ ] 点击工具栏"云开发"图标
- [ ] 创建云开发环境（记录环境ID）
- [ ] 配置 `miniprogram/app.js` 中的环境ID

```javascript
wx.cloud.init({
  env: 'your-env-id', // ✏️ 替换为你的环境ID
  traceUser: true,
});
```

---

### 步骤2：安装前端依赖

```bash
cd miniprogram
npm install
```

- [ ] 依赖安装成功
- [ ] 生成 `miniprogram/node_modules` 目录

---

### 步骤3：构建npm包

在微信开发者工具中：

- [ ] 点击菜单栏 **工具** → **构建 npm**
- [ ] 等待构建完成（约10-30秒）
- [ ] 生成 `miniprogram/miniprogram_npm` 目录
- [ ] 控制台无错误提示

---

### 步骤4：部署云函数

#### 方法1：通过微信开发者工具（推荐）

- [ ] 找到 `cloudfunctions/gradeEngine` 文件夹
- [ ] 右键点击该文件夹
- [ ] 选择 **"上传并部署：云端安装依赖"**
- [ ] 等待上传完成（约30-60秒）
- [ ] 看到"上传成功"提示

#### 方法2：通过命令行

```bash
cd cloudfunctions/gradeEngine
npm install
tcb fn deploy gradeEngine
```

- [ ] 命令执行成功
- [ ] 云函数已上传

---

### 步骤5：验证部署

#### 在云开发控制台验证

- [ ] 打开[云开发控制台](https://console.cloud.tencent.com/tcb)
- [ ] 选择你的环境
- [ ] 进入"云函数"页面
- [ ] 找到 `gradeEngine` 函数
- [ ] 状态显示为"正常"

#### 在控制台测试云函数

测试输入：
```json
{
  "action": "getAllGrades",
  "data": {}
}
```

期望输出：
```json
{
  "success": true,
  "data": [
    { "key": "grade_1_2", "name": "一二年级", "level": 1 },
    { "key": "grade_3_4", "name": "三四年级", "level": 2 },
    { "key": "grade_5_6", "name": "五六年级", "level": 3 }
  ]
}
```

- [ ] 测试成功
- [ ] 返回数据正确

---

### 步骤6：前端测试

在小程序首页测试：

- [ ] 点击年级选择器
- [ ] 能看到"一二年级"、"三四年级"、"五六年级"
- [ ] 选择年级后，题型列表动态加载
- [ ] 点击题型卡片，跳转到练习页面
- [ ] 题目正常生成（约2-3秒）
- [ ] 题目显示正确

---

### 步骤7：完整功能测试

#### 首页功能

- [ ] 年级选择器正常工作
- [ ] 题型卡片根据年级动态显示
- [ ] 难度标识正确（⭐、⭐⭐、⭐⭐⭐）
- [ ] 今日统计数据显示正常

#### 练习页功能

- [ ] 题目正常生成
- [ ] 答题计时正常
- [ ] 提交答案后即时反馈
- [ ] 正确题目显示绿色动画
- [ ] 错误题目显示红色动画
- [ ] 进度条正常显示

#### 结果页功能

- [ ] 正确率计算正确
- [ ] 用时显示正确
- [ ] 错题自动加入错题本
- [ ] 可以再来一次

#### 错题本功能

- [ ] 错题列表正常显示
- [ ] 可以查看错题详情
- [ ] 可以标记已掌握
- [ ] 可以重新练习

---

## 🔍 问题排查

### 问题1：云函数调用失败

**症状**：提示"cloud.callFunction:fail"

**排查步骤**：
- [ ] 检查云开发环境是否已初始化
- [ ] 检查云函数是否已成功部署
- [ ] 检查函数名称是否为 `gradeEngine`
- [ ] 查看云函数日志（控制台）
- [ ] 重新编译小程序

---

### 问题2：题目不显示

**症状**：练习页面显示加载中，但没有题目

**排查步骤**：
- [ ] 检查传递的参数是否正确
- [ ] 查看控制台错误信息
- [ ] 测试云函数是否正常（控制台）
- [ ] 检查网络连接
- [ ] 查看云函数日志

---

### 问题3：年级选择器为空

**症状**：点击年级选择器，没有选项

**排查步骤**：
- [ ] 检查 `getAllGrades` 接口是否正常
- [ ] 查看控制台是否有错误
- [ ] 检查 `gradeApi.js` 是否正确引入
- [ ] 重新编译小程序

---

### 问题4：题型列表为空

**症状**：选择年级后，题型列表不显示

**排查步骤**：
- [ ] 检查 `getCategoriesByGrade` 接口
- [ ] 确认年级key格式正确（如：`grade_1_2`）
- [ ] 查看控制台错误信息
- [ ] 测试云函数返回数据

---

## 📊 性能检查

### 响应时间

- [ ] 云函数冷启动 < 500ms
- [ ] 云函数热启动 < 100ms
- [ ] 生成10题 < 200ms
- [ ] 生成20题 < 300ms
- [ ] 生成50题 < 500ms

### 内存占用

- [ ] 小程序运行内存 < 200MB
- [ ] 云函数运行内存 < 128MB
- [ ] 题目数据存储 < 1MB

---

## 🔐 安全检查

- [ ] 云函数已配置权限
- [ ] 参数校验已实现
- [ ] 错误处理已完善
- [ ] 日志记录已配置

---

## 📚 文档检查

- [ ] README.md 已更新
- [ ] CLOUD_FUNCTION_GUIDE.md 已创建
- [ ] GRADE_ENGINE_QUICK_START.md 已创建
- [ ] cloudfunctions/gradeEngine/README.md 已创建
- [ ] GRADE_ENGINE_DEVELOPMENT_SUMMARY.md 已创建

---

## ✅ 最终验证

### 核心功能验证

- [ ] 1-2年级题目生成正常
- [ ] 3-4年级题目生成正常
- [ ] 5-6年级题目生成正常
- [ ] 所有题型都能正常生成
- [ ] 题目难度符合年级要求
- [ ] 没有重复题目

### 用户体验验证

- [ ] 页面加载流畅
- [ ] 操作响应及时
- [ ] 动画效果正常
- [ ] 错误提示友好
- [ ] 数据保存正确

---

## 🎉 部署完成确认

当所有检查项都通过后：

- [ ] 项目可以正常运行
- [ ] 所有核心功能正常
- [ ] 文档完整
- [ ] 性能达标
- [ ] 无明显bug

**恭喜！年级题型智能匹配引擎部署成功！** 🎊

---

## 📞 获取帮助

### 遇到问题？

1. ✅ 查看本清单的"问题排查"部分
2. ✅ 阅读 [CLOUD_FUNCTION_GUIDE.md](./CLOUD_FUNCTION_GUIDE.md)
3. ✅ 查看云函数日志（云开发控制台）
4. ✅ 参考 [GRADE_ENGINE_QUICK_START.md](./GRADE_ENGINE_QUICK_START.md)

### 联系支持

- 微信开发者社区：https://developers.weixin.qq.com/community/
- 云开发文档：https://developers.weixin.qq.com/miniprogram/dev/wxcloud/

---

**部署时间**: ___________  
**部署人员**: ___________  
**环境ID**: ___________  

---

<div align="center">
  <p>✅ 祝部署顺利！</p>
  <p>🎓 基于教学大纲 | 🚀 智能匹配 | ☁️ 云端生成</p>
</div>
